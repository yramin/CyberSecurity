# Agent Configuration
agents:
  log_monitor:
    enabled: true
    scan_interval: 5  # seconds
    log_paths:
      - /var/log/syslog
      - /var/log/apache2/access.log
      - /var/log/nginx/access.log
      - data/sample_logs/
    patterns:
      - "SQL_INJECTION"
      - "XSS_ATTACK"
      - "BRUTE_FORCE"
      - "UNAUTHORIZED_ACCESS"
      - "MALWARE_SIGNATURE"
    anomaly_threshold: 0.7
    alert_severity_levels:
      critical: 0.9
      high: 0.7
      medium: 0.5
      low: 0.3

  threat_intelligence:
    enabled: true
    virustotal:
      api_key: "${VIRUSTOTAL_API_KEY}"
      rate_limit: 4  # requests per minute
      timeout: 30
    nvd:
      api_key: "${NVD_API_KEY}"
      rate_limit: 50  # requests per 30 seconds
      timeout: 30
    mitre_attack:
      enabled: true
      data_source: "data/knowledge_base/mitre_attack.json"
    ioc_check_interval: 60  # seconds

  vulnerability_scanner:
    enabled: true
    trivy:
      enabled: true
      binary_path: "/usr/local/bin/trivy"
      timeout: 300
    bandit:
      enabled: true
      severity_level: "medium"
      confidence_level: "medium"
    safety:
      enabled: true
      check_live: false
    zap:
      enabled: false  # Requires ZAP proxy running
      api_url: "http://localhost:8080"
      api_key: "${ZAP_API_KEY}"
    scan_schedule: "0 2 * * *"  # Daily at 2 AM

  incident_response:
    enabled: true
    auto_remediation: false
    playbook_path: "data/knowledge_base/playbooks/"
    max_remediation_steps: 10
    llm_model: "claude-sonnet-4"

  policy_checker:
    enabled: true
    frameworks:
      - "ISO27001"
      - "NIST"
      - "SOC2"
    compliance_check_interval: 3600  # 1 hour
    report_format: "json"

# RAG Configuration
rag:
  chromadb:
    persist_directory: "data/chroma_db"
    collection_name: "security_knowledge"
  embedding_model: "sentence-transformers/all-MiniLM-L6-v2"
  top_k_results: 5
  similarity_threshold: 0.7
  max_context_length: 4000

# LLM Configuration
llm:
  provider: "anthropic"
  model: "claude-sonnet-4-20250514"
  api_key: "${ANTHROPIC_API_KEY}"
  max_tokens: 4096
  temperature: 0.3
  timeout: 60
  retry_attempts: 3
  retry_delay: 2

# API Configuration
api:
  host: "0.0.0.0"
  port: 8000
  workers: 4
  rate_limit:
    enabled: true
    requests_per_minute: 60
  cors:
    enabled: true
    origins:
      - "http://localhost:3000"
      - "http://localhost:5173"

# Database Configuration
database:
  type: "sqlite"
  path: "data/cyber_security.db"
  echo: false
  pool_size: 10

# Logging Configuration
logging:
  level: "INFO"
  format: "json"
  file: "logs/app.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# WebSocket Configuration
websocket:
  enabled: true
  ping_interval: 30
  ping_timeout: 10
  max_connections: 100

